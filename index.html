<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>【编程开发技术】C语言获取文件大小相关操作 by ZhangHuty</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>【编程开发技术】C语言获取文件大小相关操作</h1>
        <h2></h2>

        <section id="downloads">
          <a href="https://github.com/ZhangHuty/Develop1/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/ZhangHuty/Develop1/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/ZhangHuty/Develop1" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a id="c语言获取文件大小相关操作" class="anchor" href="#c%E8%AF%AD%E8%A8%80%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>C语言获取文件大小相关操作</h1>

<hr>

<p>声明：引用请注明出处<a href="http://blog.csdn.net/lg1259156776/">http://blog.csdn.net/lg1259156776/</a></p>

<hr>

<h2>
<a id="说明" class="anchor" href="#%E8%AF%B4%E6%98%8E" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>说明</strong>
</h2>

<p>通常在希望从文件中把数据全都出来赋值给一个数组或者某一个指针，然后再进行相关的数据处理，比如解码等操作。而在进行赋值以前，数组或者指针都需要进行内存分配，通常对于数组可以直接以文件最大的字节数进行分配，或者指针用malloc也按照最大字节进行分配，但这样会造成内存浪费，对于追求完美的程序员来讲是不能容忍的。所以一种非常适合的方法是在读取文件具体数据之前，可以提前获得文件大小，然后利用malloc对指针进行内存分配，然后再进行数据读取，直接fread对应的数据即可。本文给出了一种最简单的获取文件大小的方法。</p>

<h2>
<a id="程序代码" class="anchor" href="#%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81" aria-hidden="true"><span class="octicon octicon-link"></span></a>程序代码</h2>

<pre><code>     FILE * fImage;
     int Length;
     unsigned char * ImageData;
     if((fImage=fopen("Bretagne2.j2k","rb"))!=NULL)//寻找文件的大小!
     {
        fseek(fImage,0,SEEK_END);
        Length=ftell(fImage);
        printf("data size = %ld\n",Length);
        fseek(fImage,0,SEEK_SET);
        ImageData = (unsigned char *)malloc(Length);
        fread(ImageData,1,Length,fImage);
        if(!ImageData)
        {
            printf("malloc error! \n");
            return;
        }
        fclose(fImage);
    }
    else 
    {
        printf("Open Data error!\n");
        return;
    }
</code></pre>

<p>首先是打开文件，然后将文件指针调整到文件尾部，然后使用ftell获取文件指针的位置，ftell返回值就是用于得到文件位置指针当前位置相对于文件首的偏移字节数。这样就很简单的获取这个文件的大小了。同时直接使用malloc进行内存分配，然后直接读取即可，十分方便。</p>

<hr>

<blockquote>
<p>2015-10-18调试记录总结 张朋艺</p>
</blockquote>
      </section>
    </div>

    
  </body>
</html>
